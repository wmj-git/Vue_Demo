{"version":3,"sources":["webpack:///./src/utils/ol/fn.js"],"names":["$","__webpack_exports__","dataUrl","_Key","_clusterImgUrl","_distance","_featureKey","type","titleKey","iconUrl","k","_url","esrijsonFormat","ol","format","EsriJSON","vectorSource","source","Vector","loader","extent","resolution","projection","url","encodeURIComponent","getFeatures","length","console","log","ajax","async","dataType","success","response","error","message","details","join","features","readFeatures","featureProjection","_DATA","forEach","feature","setId","get","_keys","getKeys","_featureData","_key","getCoordinates","set","push","addFeatures","strategy","loadingstrategy","tile","tilegrid","createXYZ","tileSize","wrapX","clusterSource","Cluster","distance","styleCache","layer","name","layer_type","style","_data","size","Style","image","Icon","anchor","anchorXUnits","anchorYUnits","opacity","scale","color","src","text","Text","toString","fill","Fill","originalFeature","offsetX","offsetY","stroke","Stroke","width","layerFN","clustersFn","emMap","__WEBPACK_IMPORTED_MODULE_0__store__","__webpack_require__","formatDegree","pValue","value","Math","abs","v1","floor","round","createQeomStyle","_feature","_style","strokeWidth","JSON","parse","strokeColor","fillColor","_features","_geomStyle","geomType","_geomKey","i","coordinates","gpsLongitude","gpsLatitude","Feature","geometry","geom","Point","featureData","setStyle","LineString","Polygon","radius","circleIn4326","Circle","proj","transform","id","_clusterColor","iconUrlKey","_name","this","el","resolutions","map","view","Info","InfoOverlay","xfsMarker","xfsExptionObj","xfsExptionOverlays","fireObj","fireOverlays","personMarker","personLine","coordinate_container","coordinate_content","coordinate_closer","coordinate_overlay","measureSource","measureVector","helpTooltip_Overlays","measureTooltip_Overlays","sketch","helpTooltipElement","helpTooltip","measureTooltipElement","measureTooltip","continuePolygonMsg","continueLineMsg","measure_draw","scopeClick","evt","coordinate","appData","scopeFn","lng","lat","un","prototype","init","_LngLat","_layers","_this","_resolutions","View","center","zoom","maxZoom","minZoom","Map","controls","control","defaults","attribution","rotate","extend","target","layers","on","e","_map","_extent","getView","calculateExtent","getSize","_zoom","getCenter","getZoom","getLayers","getArray","_layer","_source","getSource","setDistance","append","document","getElementById","Overlay","element","positioning","stopEvent","offset","autoPan","autoPanAnimation","duration","addOverlay","InfoPointermoveFn","InfoClickFn","addLayer","viewFn","_num","_center","animate","xfsMarkerFn","data","_this2","removeLayer","clearXfsExptionOverlayFn","googleLang","googleLat","hydrantAvailableState","_popup","position","className","getElement","infoFn","content","css","personMarkerFn","_coordinate","axis","modelName","personLineFn","_coordinates","time","accountNo","_obj","_k","scope","scopeToolFn","_mapNmame","store","getters","window","_Info","forEachFeatureAtPixel","pixel","addClass","getId","split","hide","dragging","getEventPixel","originalEvent","hit","hasFeatureAtPixel","_type","OBJ","_content","_OBJ","obj","hydrantTypeCanme","addressInfo","treeContent","alarmTimeStr","alarmLevelCname","alarmTypeCname","alarmAddress","alarmDesc","dept","PhoneNumber","address","personContent","html","show","setPosition","coordinateLisen","_coordinateContent","_coordinateOverlay","toStringHDMS","toLonLat","innerHTML","coordinateOnFn","onclick","undefined","blur","coordinateOffFn","remove","removeOverlay","pointerMoveHandler","_helpTooltipElement","_helpTooltip","_continuePolygonMsg","_continueLineMsg","helpMsg","getGeometry","classList","formatLength","line","sphere","getLength","formatArea","polygon","area","getArea","addInteraction","interaction","Draw","lineDash","createMeasureTooltip","createHelpTooltip","listener","tooltipCoord","output","getInteriorPoint","getLastCoordinate","setOffset","Observable","unByKey","parentNode","removeChild","createElement","measureOn","removeInteraction","measureOff","measureClear","clear","addFireFn","_icon","_this3","_loop","_el","clearOverlayFn","_overlay","_overlays"],"mappings":"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","file":"static/js/0.686a4ce2f5a8d1324a55.js","sourcesContent":["import store from '@/store'\r\n\r\n//经纬度换算\r\nfunction formatDegree(pValue) {\r\n  var value = Math.abs(pValue);\r\n  var v1 = Math.floor(value);\r\n  var v2 = Math.floor((value - v1) * 60);\r\n  var v3 = Math.round((value - v1) * 3600 % 60);\r\n  return v1 + '°' + v2 + '\\'' + v3 + '\"';\r\n}\r\n\r\n\r\nexport function createQeomStyle(_feature, _style) {\r\n  let Style = null;\r\n  switch (_style.type) {\r\n    case \"1\":\r\n      Style = new ol.style.Style({\r\n        stroke: new ol.style.Stroke({\r\n          width: _style.strokeWidth,\r\n          color:  JSON.parse(_style.strokeColor)\r\n        }),\r\n        fill: new ol.style.Fill({\r\n          color: JSON.parse(_style.fillColor)\r\n        }),\r\n        text: new ol.style.Text({\r\n          text: _feature[_style.titleKey] ? _feature[_style.titleKey] + \"\" : \"\",\r\n          offsetX: 0,\r\n          offsetY: -28,\r\n          fill: new ol.style.Fill({\r\n            color: '#fff'\r\n          }),\r\n          stroke: new ol.style.Stroke({\r\n            color: 'rgba(0, 0, 0, 0.6)',\r\n            width: 4\r\n          }),\r\n        })\r\n      });\r\n      break;\r\n    case \"2\"://text形式\r\n      Style = new ol.style.Style({\r\n        text: new ol.style.Text({\r\n          text: _feature[_style.titleKey] ? _feature[_style.titleKey] + \"\" : \"\",\r\n          fill: new ol.style.Fill({\r\n            color: JSON.parse(_style.fillColor)\r\n          }),\r\n          stroke: new ol.style.Stroke({\r\n            color: JSON.parse(_style.strokeColor),\r\n            width: _style.strokeWidth\r\n          }),\r\n        })\r\n      });\r\n      break;\r\n\r\n  }\r\n  return Style;\r\n}\r\n\r\n//获取时空云数据\r\nexport function clustersLayerFn(dataUrl, _Key, _clusterImgUrl, _distance) {//时空云数据\r\n  // let _extent = [113.97796915, 22.608145238000002, 114.04398656100001, 22.704755608];\r\n\r\n\r\n  let _featureKey = {\r\n    type: \"typeName\",//类型\r\n    titleKey: \"id\",//标题\r\n    iconUrl: \"\"//图标地址\r\n  };\r\n  for (let k in _featureKey) {\r\n    if (_Key[k]) {\r\n      _featureKey[k] = _Key[k];\r\n    }\r\n  }\r\n  let _url = dataUrl ? dataUrl : \"\";\r\n  let esrijsonFormat = new ol.format.EsriJSON();\r\n  let vectorSource = new ol.source.Vector({\r\n    loader: function (extent, resolution, projection) {\r\n      var url = _url + '/query/?f=json&' +\r\n        'returnGeometry=true&spatialRel=esriSpatialRelIntersects&geometry=' +\r\n        encodeURIComponent('{\"xmin\":' + extent[0] + ',\"ymin\":' +\r\n          extent[1] + ',\"xmax\":' + extent[2] + ',\"ymax\":' + extent[3] +\r\n          ',\"spatialReference\":{\"wkid\":4490}}') +\r\n        '&geometryType=esriGeometryEnvelope&inSR=4490&outFields=*' +\r\n        '&outSR=4490';\r\n\r\n      if (vectorSource.getFeatures().length > 0) {\r\n        // vectorSource.clear();\r\n        console.log(vectorSource.getFeatures());\r\n        return\r\n      }\r\n\r\n      $.ajax({\r\n        url: url, async: true, dataType: 'json', success: function (response) {\r\n          /* console.log(\"response\");\r\n           console.log(response);*/\r\n          if (response.error) {\r\n            console.log(response.error.message + '\\n' +\r\n              response.error.details.join('\\n'));\r\n          } else {\r\n            // dataProjection will be read from document\r\n            var features = esrijsonFormat.readFeatures(response, {\r\n              featureProjection: projection\r\n            });\r\n            if (features.length > 0) {\r\n              let _DATA = [];\r\n              features.forEach(function (feature) {\r\n                feature.setId(_featureKey.type + \"_\" + feature.get(_featureKey.titleKey));\r\n                let _keys = feature.getKeys();\r\n                let _featureData = {};\r\n                _keys.forEach(function (_key) {\r\n\r\n                  if (_key === \"geometry\") {\r\n\r\n                  } else {\r\n                    _featureData[_key] = feature.get(_key);\r\n                  }\r\n                });\r\n                _featureData[\"coordinates\"] = feature.get(\"geometry\").getCoordinates();\r\n                feature.set(\"featureData\", _featureData);\r\n                _DATA.push(_featureData);\r\n              });\r\n              console.log(\"features2\");\r\n              // console.log(features);\r\n              console.log(_DATA);\r\n              vectorSource.addFeatures(features);\r\n\r\n            }\r\n          }\r\n        }\r\n      });\r\n    },\r\n    strategy: ol.loadingstrategy.tile(ol.tilegrid.createXYZ({\r\n      tileSize: 512\r\n    })),\r\n    wrapX: false\r\n  });\r\n\r\n\r\n  let clusterSource = new ol.source.Cluster({\r\n    distance: _distance,\r\n    source: vectorSource\r\n  });\r\n\r\n  function createEarthquakeStyle(iconFeature) {\r\n\r\n    // console.log(iconFeature.getKeys());\r\n\r\n\r\n    let _data = iconFeature.get(_featureKey.titleKey);\r\n\r\n    let iconStyle = new ol.style.Style({\r\n      image: new ol.style.Icon(({\r\n        anchor: [0, 0],\r\n        anchorXUnits: 'fraction',\r\n        anchorYUnits: 'pixels',\r\n        scale: 0.4,\r\n        src: _featureKey.iconUrl + \"\"\r\n      })),\r\n      text: new ol.style.Text({\r\n        text: _data + \"\",\r\n        // text:  \"123\",\r\n        offsetX: 12,\r\n        offsetY: -8,\r\n        fill: new ol.style.Fill({\r\n          color: '#fff'\r\n        }),\r\n        stroke: new ol.style.Stroke({\r\n          color: 'rgba(0, 0, 0, 0.6)',\r\n          width: 4\r\n        }),\r\n      })\r\n    });\r\n\r\n    return iconStyle;\r\n  }\r\n\r\n  let styleCache = {};\r\n  let layer = new ol.layer.Vector({\r\n    name: _featureKey.type + \"_layer\",\r\n    layer_type: \"Cluster\",\r\n    source: clusterSource,\r\n    style: function (feature) {\r\n      var size = feature.get('features').length;\r\n      // console.log(feature.get('features'));\r\n      var style = styleCache[size];\r\n      if (size > 1) {\r\n        if (!style) {\r\n          style = new ol.style.Style({\r\n            image: new ol.style.Icon(({\r\n              anchor: [0.5, 28],\r\n              anchorXUnits: 'fraction',\r\n              anchorYUnits: 'pixels',\r\n              opacity: 0.8,\r\n              scale: 1.28,\r\n              color: _clusterImgUrl,\r\n              src: \"../../static/image/cluster.png\"\r\n            })),\r\n            text: new ol.style.Text({\r\n              text: size.toString(),\r\n              fill: new ol.style.Fill({\r\n                color: '#fff'\r\n              })\r\n            })\r\n          });\r\n          styleCache[size] = style;\r\n        }\r\n      } else {\r\n        var originalFeature = feature.get('features')[0];\r\n        style = createEarthquakeStyle(originalFeature);\r\n      }\r\n      return style;\r\n    }\r\n  });\r\n\r\n  return {\r\n    layer, vectorSource, clusterSource\r\n  }\r\n}\r\n\r\n//几何类型没有聚合的数据图层\r\nexport function layerFN(_features, _Key, _geomStyle) {\r\n\r\n  let features = [];\r\n  let source = null;\r\n  let layer = null;\r\n\r\n  let _featureKey = {\r\n    type: \"layerName\",//类型\r\n    geomType: \"Point\",//几何对象类型\r\n  };\r\n  for (let k in _featureKey) {\r\n    if (_Key[k]) {\r\n      _featureKey[k] = _Key[k];\r\n    }\r\n  }\r\n\r\n  let _geomKey = {\r\n    type: \"\",//样式类型\r\n    titleKey: \"id\",//标题\r\n    strokeWidth: 2,\r\n    strokeColor: \"[255, 0, 0, 1.0]\",\r\n    fillColor: \"[0, 0, 255, 1.0]\"\r\n  };\r\n  for (let k in _geomKey) {\r\n    if (_geomStyle[k]) {\r\n      _geomKey[k] = _geomStyle[k];\r\n    }\r\n  }\r\n\r\n\r\n  source = new ol.source.Vector({\r\n    wrapX: false\r\n  });\r\n\r\n  for (let i = 0; i < _features.length; ++i) {\r\n\r\n    if (_featureKey.geomType === \"Point\") {//点\r\n      let coordinates = [_features[i].gpsLongitude, _features[i].gpsLatitude];\r\n      features[i] = new ol.Feature({\r\n        geometry: new ol.geom.Point(coordinates),\r\n        featureData: _features[i]\r\n      });\r\n    } else if (_featureKey.geomType === \"Text\") {//文本\r\n      let coordinates = [_features[i].gpsLongitude, _features[i].gpsLatitude];\r\n      features[i] = new ol.Feature({\r\n        geometry: new ol.geom.Point(coordinates),\r\n        featureData: _features[i]\r\n      });\r\n      features[i].setStyle(createQeomStyle(_features[i], _geomKey));\r\n    } else if (_featureKey.geomType === \"LineString\") {//线\r\n      let coordinates = _features[i].coordinates ? _features[i].coordinates : [];\r\n      features[i] = new ol.Feature({\r\n        geometry: new ol.geom.LineString(coordinates),\r\n        featureData: _features[i]\r\n      });\r\n      features[i].setStyle(createQeomStyle(_features[i], _geomKey));\r\n    } else if (_featureKey.geomType === \"Polygon\") {//多边形\r\n      let coordinates = _features[i].coordinates ? _features[i].coordinates : [];\r\n      features[i] = new ol.Feature({\r\n        geometry: new ol.geom.Polygon(coordinates),\r\n        featureData: _features[i]\r\n      });\r\n      features[i].setStyle(createQeomStyle(_features[i], _geomKey));\r\n    } else if (_featureKey.geomType === \"Circle\") {//圆\r\n      let coordinates = [_features[i].gpsLongitude, _features[i].gpsLatitude];\r\n      let radius = _features[i].radius ? _features[i].radius : 10;\r\n      let circleIn3857 = new ol.geom.Circle(ol.proj.transform(coordinates, 'EPSG:4326', 'EPSG:3857'), radius, 'XY');\r\n      let circleIn4326 = circleIn3857.transform('EPSG:3857', 'EPSG:4326');\r\n\r\n      features[i] = new ol.Feature({\r\n        geometry: circleIn4326,\r\n        featureData: _features[i]\r\n      });\r\n\r\n      features[i].setStyle(createQeomStyle(_features[i], _geomKey));\r\n    }\r\n\r\n    features[i].setId(_featureKey.type + \"_\" + _features[i].id);\r\n  }\r\n\r\n\r\n  source.addFeatures(features);\r\n  layer = new ol.layer.Vector({\r\n    name: _featureKey.type + \"_layer\",\r\n    layer_type: \"Layer\",\r\n    source: source\r\n  });\r\n\r\n  return {\r\n    features: features,\r\n    source: source,\r\n    layer: layer\r\n  }\r\n}\r\n\r\n//移除图层\r\nexport function ClearLayerFN(_map, _layers) {\r\n  console.log(Array.isArray(_layers));\r\n  if (Array.isArray(_layers)) {\r\n    _layers.forEach(function (_layer) {\r\n      _map.removeLayer(_layer);\r\n    });\r\n  }\r\n}\r\n\r\n//有聚合的数据图层\r\nexport function clustersFn(_features, _Key, _clusterColor, _distance) {//_features:数据, _Key:属性配置, _clusterImgUrl:聚合图标\r\n\r\n  /* _features=[{\r\n            id:\"\",\r\n            lng:\"\",\r\n            lat:\"\",\r\n            _Key.iconUrlKey:\"\",\r\n            ...\r\n   }]*/\r\n\r\n  let _featureKey = {\r\n    type: \"typeName\",//类型\r\n    titleKey: \"id\",//标题\r\n    iconUrlKey: \"iconUrl\"//图标地址\r\n  };\r\n  for (let k in _featureKey) {\r\n    if (_Key[k]) {\r\n      _featureKey[k] = _Key[k];\r\n    }\r\n  }\r\n\r\n  let features = [];\r\n  for (let i = 0; i < _features.length; ++i) {\r\n    let coordinates = [_features[i].gpsLongitude, _features[i].gpsLatitude];\r\n\r\n    features[i] = new ol.Feature({\r\n      geometry: new ol.geom.Point(coordinates),\r\n      featureData: _features[i]\r\n    });\r\n    features[i].setId(_featureKey.type + \"_\" + _features[i].id);\r\n  }\r\n\r\n  let clusterSource = new ol.source.Cluster({\r\n    distance: _distance,\r\n    source: new ol.source.Vector({\r\n      features: features\r\n    })\r\n  });\r\n\r\n  function createEarthquakeStyle(iconFeature) {\r\n\r\n    // console.log(iconFeature.get(\"featureData\")[_iconKey]);\r\n    let _data = iconFeature.get(\"featureData\");\r\n    let iconStyle = new ol.style.Style({\r\n      image: new ol.style.Icon(({\r\n        anchor: [32, 62],\r\n        anchorXUnits: 'pixels',\r\n        anchorYUnits: 'pixels',\r\n        scale: 0.4,\r\n        src: _data[_featureKey.iconUrlKey] + \"\"\r\n      })),\r\n      text: new ol.style.Text({\r\n        text: _data[_featureKey.titleKey] + \"\",\r\n        offsetX: 0,\r\n        offsetY: -32,\r\n        fill: new ol.style.Fill({\r\n          color: '#fff'\r\n        }),\r\n        stroke: new ol.style.Stroke({\r\n          color: 'rgba(0, 0, 0, 0.6)',\r\n          width: 4\r\n        }),\r\n      })\r\n    });\r\n\r\n    return iconStyle;\r\n  }\r\n\r\n  let styleCache = {};\r\n  let clusterLayer = new ol.layer.Vector({\r\n    name: _featureKey.type + \"_layer\",\r\n    layer_type: \"Cluster\",\r\n    source: clusterSource,\r\n    style: function (feature) {\r\n      var size = feature.get('features').length;\r\n      var style = styleCache[size];\r\n      if (size > 1) {\r\n        if (!style) {\r\n          style = new ol.style.Style({\r\n            image: new ol.style.Icon(({\r\n              anchor: [0.5, 28],\r\n              anchorXUnits: 'fraction',\r\n              anchorYUnits: 'pixels',\r\n              opacity: 0.8,\r\n              scale: 1.28,\r\n              color: _clusterColor,\r\n              src: \"../../static/image/cluster.png\"\r\n            })),\r\n            text: new ol.style.Text({\r\n              text: size.toString(),\r\n              fill: new ol.style.Fill({\r\n                color: '#fff'\r\n              })\r\n            })\r\n          });\r\n          styleCache[size] = style;\r\n        }\r\n      } else {\r\n        // clusterSource.setDistance(0);\r\n        var originalFeature = feature.get('features')[0];\r\n        // console.log(originalFeature);\r\n        style = createEarthquakeStyle(originalFeature);\r\n      }\r\n      return style;\r\n    }\r\n  });\r\n\r\n  return {\r\n    features: features,\r\n    source: clusterSource,\r\n    layer: clusterLayer\r\n  }\r\n\r\n}\r\n\r\nfunction treeContent(_OBJ) {//消防栓信息显示模板\r\n  console.log(\"OBJ\");\r\n  console.log(_OBJ);\r\n  let obj = _OBJ.content;\r\n  let _content = '<ul type=\"none\" style=\"margin: 0px;padding:0px;font-size:22px;\" >' +\r\n    '<li>编号：' + (obj.id || \"无\") + '<\\/li>' +\r\n    '<li>规格型号：' + 'DN65*2,' + obj.hydrantTypeCanme + '<\\/li>' +\r\n    '<li>安装位置：' + obj.addressInfo + '<\\/li>' +\r\n    '<\\/ul>';\r\n\r\n  return _content;\r\n}\r\n\r\nfunction personContent(_OBJ) {//消防栓信息显示模板\r\n\r\n  let _data = _OBJ.content;\r\n\r\n  let _content = '<ul type=\"none\" style=\"margin: 0px;padding:0px;font-size: 22px\">' +\r\n    '<li>姓   名：' + _data.name + '<\\/li>' +\r\n    '<li>单   位：' + _data.dept + '<\\/li>' +\r\n    '<li>电   话：' + _data.PhoneNumber + '<\\/li>' +\r\n    '<li>位   置：' + _data.address + '<\\/li>' +\r\n    '<\\/ul>';\r\n\r\n  return _content;\r\n}\r\n\r\nfunction fireContent(_OBJ) {//火警信息显示模板\r\n\r\n  let _data = _OBJ.content;\r\n\r\n  let _content = '<ul type=\"none\" style=\"margin: 0px;padding:0px;font-size:22px;\">' +\r\n    '<li>报警时间：' + (_data.alarmTimeStr || \"无\") + '<\\/li>' +\r\n    '<li>报警等级：' + (_data.alarmLevelCname || \"无\") + '<\\/li>' +\r\n    '<li>报警类型：' + (_data.alarmTypeCname || \"无\") + '<\\/li>' +\r\n    '<li>报警位置：' + (_data.alarmAddress || \"无\") + '<\\/li>' +\r\n    '<li>报警描述：' + (_data.alarmDesc || \"无\") + '<\\/li>' +\r\n    '<\\/ul>' +\r\n    '<ul type=\"none\" style=\"margin: 0px;padding:0 0 0 18px;font-size:22px;\"  class=\"list_style_main\">' +\r\n    '<li>' +\r\n    '<input type=\"button\"  value=' + \"派遣任务\" + ' onclick=\"fireDispatchFn()\">' +\r\n    '<\\/li>' +\r\n    '<li>' +\r\n    '<input type=\"button\"  value=' + \"解除报警\" + ' onclick=\"fireCloseFn()\">' +\r\n    '<\\/li>' +\r\n    '<\\/ul>';\r\n\r\n  return _content;\r\n}\r\n\r\n\r\nexport function emMap(_name) {\r\n  this.el = _name;\r\n  this.resolutions = [\r\n    5.9486525145757E-4, 2.97432625728785E-4,\r\n    1.5228550437313792E-4, 7.614275218656896E-5,\r\n    3.807137609328448E-5, 1.903568804664224E-5,\r\n    9.51784402332112E-6, 4.75892201166056E-6,\r\n    2.37946100583028E-6, 1.18973050291514E-6,\r\n    5.9486525145757E-7, 2.97432625728785E-7];\r\n  this.map = null;\r\n  this.view = null;\r\n  // 信息框\r\n  this.Info = null;\r\n  this.InfoOverlay = null;\r\n\r\n  // 消防栓\r\n  this.xfsMarker = null;\r\n  this.xfsExptionObj = null;\r\n  this.xfsExptionOverlays = [];\r\n\r\n  // 火警\r\n  this.fireObj = null;\r\n  this.fireOverlays = [];\r\n\r\n  // 人员\r\n  this.personMarker = null;\r\n  //人员轨迹\r\n  this.personLine = null;\r\n\r\n  // 坐标\r\n  this.coordinate_container = null;\r\n  this.coordinate_content = null;\r\n  this.coordinate_closer = null;\r\n  this.coordinate_overlay = null;\r\n\r\n  //测量\r\n  this.measureSource = null;\r\n  this.measureVector = null;\r\n  this.helpTooltip_Overlays = [];\r\n  this.measureTooltip_Overlays = [];\r\n  this.sketch = null;\r\n  this.helpTooltipElement = null;\r\n  this.helpTooltip = null;\r\n  this.measureTooltipElement = null;\r\n  this.measureTooltip = null;\r\n  this.continuePolygonMsg = '测量面积';\r\n  this.continueLineMsg = '测量距离';\r\n  this.measure_draw = null;\r\n\r\n}\r\n\r\nemMap.prototype.init = function (_LngLat, _layers) {\r\n\r\n  let _this = this;\r\n  let _resolutions = this.resolutions;\r\n  this.view = new ol.View({\r\n    resolutions: _resolutions,\r\n    center: _LngLat,\r\n    zoom: 0,\r\n    maxZoom: 19,\r\n    minZoom: 0,\r\n    projection: 'EPSG:4326',\r\n  });\r\n  this.map = new ol.Map({\r\n    controls: ol.control.defaults({attribution: false, zoom: false, rotate: true}).extend([\r\n      //new ol.control.LayerSwitcher({ trash: false, extent: true }),\r\n      //new ol.control.ScaleLine(),\r\n      //new ol.control.Zoom({ target: undefined}),\r\n      //new ol.control.Rotate({\r\n      // autoHide: true,\r\n      // label: “N”\r\n      //}),\r\n      //new ol.control.MeasureTool({ sphereradius: 6378137 })\r\n    ]),\r\n    target: _this.el,\r\n    layers: _layers,\r\n    view: _this.view\r\n  });\r\n  this.map.on('moveend', function (e) {\r\n    let _map = e.map;\r\n    let _extent = _map.getView().calculateExtent(_map.getSize());\r\n    let _point = ol.extent.getCenter(_extent);\r\n    // console.log(_point);\r\n    /* $.each(appData.gis, function (i, n) {\r\n       n.GisIcon(_point[0], _point[1]);\r\n       n.GisView(_point[0], _point[1]);\r\n     });*/\r\n\r\n    let _zoom = _this.view.getZoom();\r\n    // console.log(_zoom);\r\n\r\n    let _layers = _map.getLayers().getArray();\r\n    if (_zoom > 6) {\r\n      _layers.forEach(function (_layer) {\r\n        let _source = _layer.getSource();\r\n        if (_layer.get(\"layer_type\") === \"Cluster\") {\r\n          _source.setDistance(0);\r\n        }\r\n      });\r\n    } else {\r\n      _layers.forEach(function (_layer) {\r\n        let _source = _layer.getSource();\r\n        if (_layer.get(\"layer_type\") === \"Cluster\") {\r\n          _source.setDistance(50);\r\n        }\r\n      });\r\n    }\r\n  });\r\n\r\n  $(\"body\").append(`<div id=\"em_ol_info\" class=\"em-tooltip em-tooltip-static\" style=\"z-index: 800\"></div>`);\r\n  this.Info = document.getElementById('em_ol_info');\r\n  this.InfoOverlay = new ol.Overlay({\r\n    element: this.Info,\r\n    positioning: 'bottom-center',\r\n    stopEvent: false,\r\n    offset: [6, -32],\r\n    autoPan: true,\r\n    autoPanAnimation: {\r\n      duration: 100\r\n    }\r\n  });\r\n  this.map.addOverlay(this.InfoOverlay);\r\n  this.map.on('pointermove', this.InfoPointermoveFn);\r\n  this.map.on('click', this.InfoClickFn);\r\n\r\n\r\n  // 测量\r\n  this.measureSource = new ol.source.Vector();\r\n  this.measureVector = new ol.layer.Vector({\r\n    source: this.measureSource,\r\n    style: new ol.style.Style({\r\n      fill: new ol.style.Fill({\r\n        color: 'rgba(255, 255, 255, 0.4)'\r\n      }),\r\n      stroke: new ol.style.Stroke({\r\n        color: '#ffcc33',\r\n        width: 2\r\n      }),\r\n      image: new ol.style.Circle({\r\n        radius: 7,\r\n        fill: new ol.style.Fill({\r\n          color: '#ffcc33'\r\n        })\r\n      })\r\n    })\r\n  });\r\n  this.map.addLayer(this.measureVector);\r\n};\r\nemMap.prototype.viewFn = function (_num, _center) {\r\n  if (_center === \"none\") {\r\n    this.view.animate({\r\n      zoom: _num,\r\n    });\r\n  } else {\r\n    this.view.animate({\r\n      center: _center,\r\n      zoom: _num,\r\n      duration: 100\r\n    });\r\n  }\r\n\r\n};\r\n\r\nemMap.prototype.xfsMarkerFn = function (data) {\r\n  let _this = this;\r\n  let _data = data;\r\n  //创建图片对象\r\n  var icon = \"images/hybrant_mark_ok.png\";\r\n  var icon1 = \"images/hybrant_mark_success1.png\";\r\n  var icon2 = \"images/hybrant_mark_success2.gif\";\r\n  var icon3 = \"images/hybrant_mark_success3.png\";\r\n  var icon4 = \"images/hybrant_mark_success2.png\";\r\n\r\n\r\n  if (this.xfsMarker) {\r\n    this.map.removeLayer(this.xfsMarker.layer);\r\n    this.clearXfsExptionOverlayFn();\r\n  }\r\n\r\n  for (var i = 0; i < _data.length; i++) {\r\n\r\n    _data[i].lng = _data[i].googleLang;\r\n    _data[i].lat = _data[i].googleLat;\r\n\r\n    if (_data[i].hydrantAvailableState === 28) {\r\n      _data[i].iconUrl = icon;\r\n\r\n    } else if (_data[i].hydrantAvailableState === 29) {\r\n      _data[i].iconUrl = icon1;\r\n\r\n    } else if (_data[i].hydrantAvailableState === 31) {\r\n      _data[i].iconUrl = icon3;\r\n\r\n    } else {\r\n      if (_data[i].id <= 465) {\r\n        _data[i].iconUrl = icon2;\r\n\r\n        $(\"body\").append(`<img id=\"xfs${data[i].id}\" src=\"images/hybrant_mark_success2.gif\" style=\"width:28px;height:34px;\"/>`);\r\n        let _popup = new ol.Overlay({\r\n          id: \"xfs_\" + _data[i].id,\r\n          position: [_data[i].lng, _data[i].lat],\r\n          element: document.getElementById('xfs' + data[i].id),\r\n          className: \"xfs-overlay\"\r\n        });\r\n        _popup.set(\"overlayData\", _data[i]);\r\n        this.xfsExptionOverlays.push(_popup);\r\n        this.map.addOverlay(_popup);\r\n        $(_popup.getElement()).on('click', function () {\r\n          let _data = _popup.get(\"overlayData\");\r\n          // _this.xfsExptionObj = _data;\r\n          _this.infoFn({\r\n            type: \"xfs\",\r\n            content: _data,\r\n            lng: _data.googleLang,\r\n            lat: _data.googleLat\r\n          });\r\n        }).on(\"mouseover\", function () {\r\n          $(this).css(\"cursor\", 'pointer');\r\n        });\r\n\r\n      } else {\r\n        _data[i].iconUrl = icon4;\r\n      }\r\n    }\r\n  }\r\n\r\n  this.xfsMarker = clustersFn(_data, {\r\n    type: \"xfs\",\r\n    titleKey: \"id\",\r\n    iconUrlKey: \"iconUrl\"\r\n  }, \"images/cluster0.png\", 50);\r\n  this.map.addLayer(this.xfsMarker.layer);\r\n};\r\n// 添加人员标注\r\nemMap.prototype.personMarkerFn = function (data) {//添加覆盖物\r\n  let _data = data;\r\n  console.log(_data);\r\n\r\n  //创建图片对象\r\n  let _icon = \"images/men.png\";\r\n\r\n  for (let i = 0; i < _data.length; i++) {\r\n    let _coordinate = _data[i].axis;\r\n    _data[i].id = _data[i].modelName;\r\n    _data[i].lng = _coordinate[0];\r\n    _data[i].lat = _coordinate[1];\r\n    _data[i].iconUrl = _icon;\r\n\r\n  }\r\n  if (this.personMarker) {\r\n    this.map.removeLayer(this.personMarker.layer);\r\n  }\r\n  this.personMarker = clustersFn(_data, {\r\n    type: \"person\",\r\n    titleKey: \"name\",\r\n    iconUrlKey: \"iconUrl\"\r\n  }, \"images/men.png\", 0);\r\n  this.map.addLayer(this.personMarker.layer);\r\n\r\n};\r\n//添加人员轨迹\r\nemMap.prototype.personLineFn = function (data) {//添加覆盖物\r\n  let _data = data;\r\n  console.log(_data);\r\n  if (data.length <= 0) {\r\n    return\r\n  }\r\n  let _feature = {\r\n    id: \"\",\r\n    coordinates: []\r\n  };\r\n  let _coordinates = [];\r\n  for (let i = 0; i < _data.length; i++) {\r\n    _coordinates.push([_data[i].googleLang, _data[i].googleLat]);\r\n  }\r\n  _feature.id = _data[0].time;\r\n  _feature.accountNo = _data[0].accountNo;\r\n  _feature.coordinates = _coordinates;\r\n\r\n  if (this.personLine) {\r\n    this.map.removeLayer(this.personLine.layer);\r\n  }\r\n  this.personLine = layerFN([_feature], {\r\n    type: \"line\",\r\n    geomType: \"LineString\"\r\n  }, {\r\n    titleKey: \"accountNo\",//标题\r\n    strokeWidth: 2,\r\n    strokeColor: [0, 255, 0, 1.0],\r\n    fillColor: [0, 0, 255, 1.0]\r\n  });\r\n  this.map.addLayer(this.personLine.layer);\r\n};\r\n//范围查询功能\r\nemMap.prototype.scopeFn = function (data) {//添加覆盖物\r\n\r\n  let _data = data;\r\n  console.log(_data);\r\n  if (data.length <= 0) {\r\n    return\r\n  }\r\n  let _features = [];\r\n  let _feature = {\r\n    id: \"1\",\r\n    lng: 0,\r\n    lat: 0,\r\n    radius: 0\r\n  };\r\n\r\n  _data.forEach(function (_obj) {\r\n    for (let _k in _feature) {\r\n      _feature[_k] = _obj[_k];\r\n    }\r\n    _features.push(_feature);\r\n  });\r\n\r\n  if (this.scope) {\r\n    this.map.removeLayer(this.scope.layer);\r\n\r\n  }\r\n  this.scope = layerFN(_features, {\r\n    type: \"scope\",\r\n    geomType: \"Circle\"\r\n  }, {\r\n    titleKey: \"name\",//标题\r\n    strokeWidth: 2,\r\n    strokeColor: [0, 255, 0, 1.0],\r\n    fillColor: [0, 0, 255, 0.4]\r\n  });\r\n  this.map.addLayer(this.scope.layer);\r\n};\r\n\r\nfunction scopeClick(evt) {\r\n  let coordinate = evt.coordinate;\r\n  console.log(coordinate);\r\n  appData.map.scopeFn([{\r\n    id: \"1\",\r\n    lng: coordinate[0],\r\n    lat: coordinate[1],\r\n    radius: 100\r\n  }]);\r\n  appData.map.map.un('click', scopeClick);\r\n}\r\n\r\nemMap.prototype.scopeToolFn = function () {//添加覆盖物\r\n  let _this = this;\r\n  if (_this.scope) {\r\n    _this.map.removeLayer(_this.scope.layer);\r\n  }\r\n  _this.map.on('click', scopeClick);\r\n};\r\n\r\n// display popup on click\r\nemMap.prototype.InfoClickFn = function (evt) {\r\n  console.log(evt);\r\n\r\n  let _this = null;\r\n  let _mapNmame = store.getters[\"scene/type\"];\r\n  if (window[_mapNmame]) {\r\n    _this = window[_mapNmame];\r\n  } else {\r\n    return\r\n  }\r\n\r\n\r\n  let _Info = _this.Info;\r\n\r\n\r\n  let feature = evt.map.forEachFeatureAtPixel(evt.pixel,\r\n    function (feature) {\r\n      return feature;\r\n    });\r\n  if (feature) {\r\n    console.log(feature);\r\n    $(\".em_detail_window\").addClass(\"addWidth\");\r\n    if (feature.get('features') && feature.get('features').length === 1) {\r\n      let _feature = feature.get('features')[0];\r\n      let _type = _feature.getId().split(\"_\");\r\n\r\n\r\n    } else if (feature.get(\"featureData\")) {\r\n      let _type = feature.getId().split(\"_\");\r\n\r\n    } else {\r\n      return\r\n    }\r\n  } else {\r\n    $(_Info).hide();\r\n  }\r\n};\r\n// change mouse cursor when over marker\r\nemMap.prototype.InfoPointermoveFn = function (evt) {\r\n\r\n  let _this = null;\r\n  let _mapNmame = store.getters[\"scene/type\"];\r\n  if (window[_mapNmame]) {\r\n    _this = window[_mapNmame];\r\n  } else {\r\n    return\r\n  }\r\n\r\n  let _Info = _this.Info;\r\n\r\n  if (evt.dragging) {\r\n    $(_Info).hide();\r\n    return;\r\n  }\r\n\r\n\r\n  let pixel = evt.map.getEventPixel(evt.originalEvent);\r\n  let hit = evt.map.hasFeatureAtPixel(pixel);\r\n  $(\"#mapContainer\").css(\"cursor\", hit ? 'pointer' : '');\r\n\r\n\r\n  let feature = evt.map.forEachFeatureAtPixel(evt.pixel, function (feature) {\r\n    return feature;\r\n  });\r\n  if (feature) {\r\n    let _coordinate = evt.coordinate;\r\n    // console.log(evt.coordinate);\r\n\r\n    if (feature.get('features') && feature.get('features').length === 1) {\r\n      let _feature = feature.get('features')[0];\r\n      let _type = _feature.getId().split(\"_\");\r\n      _this.infoFn({\r\n        type: _type[0],\r\n        content: _feature.get(\"featureData\"),\r\n        // lng: _feature.get(\"featureData\").gpsLongitude,\r\n        // lat: _feature.get(\"featureData\").gpsLatitude\r\n        lng: _coordinate[0],\r\n        lat: _coordinate[1]\r\n      });\r\n    } else if (feature.get(\"featureData\")) {\r\n      let _type = feature.getId().split(\"_\");\r\n      _this.infoFn({\r\n        type: _type[0],\r\n        content: feature.get(\"featureData\"),\r\n        lng: _coordinate[0],\r\n        lat: _coordinate[1]\r\n      });\r\n    } else {\r\n      return;\r\n    }\r\n\r\n\r\n  } else {\r\n    $(_Info).hide();\r\n  }\r\n\r\n\r\n};\r\nemMap.prototype.infoFn = function (OBJ) {\r\n\r\n  /*OBJ={\r\n      type: \"info\",\r\n      content: data,\r\n      lng: data.googleLang,\r\n      lat: data.googleLat\r\n  }*/\r\n\r\n  let _content;\r\n  if (OBJ.type && OBJ.type === \"info\") {\r\n    _content = '<span style=\"color: white\">' + OBJ.content + '<\\/span>';\r\n  } else if (OBJ.type && OBJ.type === \"tree\") {\r\n    _content = treeContent(OBJ);\r\n  } else if (OBJ.type && OBJ.type === \"fire\") {\r\n    _content = fireContent(OBJ);\r\n  } else if (OBJ.type && OBJ.type === \"person\") {\r\n    _content = personContent(OBJ);\r\n  } else {\r\n    let _Content = OBJ.lng;\r\n    _content = '<span style=\"color: white;\">' + _Content + '<\\/span>';\r\n    // return\r\n  }\r\n\r\n  $(this.Info).html(_content);\r\n  $(this.Info).show();\r\n  this.InfoOverlay.setPosition([OBJ.lng, OBJ.lat]);\r\n};\r\n\r\n\r\n//坐标查询\r\nemMap.prototype.coordinateLisen = function (evt) {\r\n\r\n  let _coordinateContent = null;\r\n  let _coordinateOverlay = null;\r\n  let _mapNmame = store.getters[\"scene/type\"];\r\n  console.log(window[_mapNmame]);\r\n  if (window[_mapNmame]) {\r\n    _coordinateContent = window[_mapNmame].coordinate_content;\r\n    _coordinateOverlay = window[_mapNmame].coordinate_overlay;\r\n  } else {\r\n    return\r\n  }\r\n  let coordinate = evt.coordinate;\r\n  let hdms = ol.coordinate.toStringHDMS(ol.proj.toLonLat(coordinate));\r\n\r\n  _coordinateContent.innerHTML = '经：<code>' + formatDegree(coordinate[0]) + '</code>,<br>纬：<code>' + formatDegree(coordinate[1]) + '</code>';\r\n  console.log(coordinate);\r\n  _coordinateOverlay.setPosition(coordinate);\r\n};\r\nemMap.prototype.coordinateOnFn = function () {\r\n  let _this = this;\r\n\r\n  $(\"body\").append(`\r\n        <div id=\"coordinate\" class=\"ol-popup\">\r\n            <a href=\"#\" id=\"coordinate_closer\" class=\"ol-popup-closer\"></a>\r\n            <div id=\"coordinate_content\"></div>\r\n        </div>\r\n    `);\r\n\r\n  this.coordinate_container = document.getElementById('coordinate');\r\n  this.coordinate_content = document.getElementById('coordinate_content');\r\n  this.coordinate_closer = document.getElementById('coordinate_closer');\r\n\r\n  this.coordinate_overlay = new ol.Overlay({\r\n    element: this.coordinate_container,\r\n    autoPan: true,\r\n    autoPanAnimation: {\r\n      duration: 100\r\n    }\r\n  });\r\n\r\n  this.coordinate_closer.onclick = function () {\r\n    _this.coordinate_overlay.setPosition(undefined);\r\n    _this.coordinate_closer.blur();\r\n    return false;\r\n  };\r\n  this.map.addOverlay(this.coordinate_overlay);\r\n  this.map.on('singleclick', this.coordinateLisen);\r\n\r\n};\r\nemMap.prototype.coordinateOffFn = function () {\r\n  $(\"#coordinate\").remove();\r\n  this.map.removeOverlay(this.coordinate_overlay);\r\n  // ol.Observable.unByKey(_lisen);\r\n  this.map.un('singleclick', this.coordinateLisen);\r\n};\r\n\r\n\r\n//测量\r\nemMap.prototype.pointerMoveHandler = function (evt) {\r\n  let _helpTooltipElement = null;\r\n  let _helpTooltip = null;\r\n  let _continuePolygonMsg = null;\r\n  let _continueLineMsg = null;\r\n\r\n\r\n  let _map = null;\r\n  let _mapNmame = store.getters[\"scene/type\"];\r\n  if (window[_mapNmame]) {\r\n    _map = window[_mapNmame];\r\n  } else {\r\n    return\r\n  }\r\n\r\n\r\n  if (_map) {\r\n    _helpTooltipElement = _map.helpTooltipElement;\r\n    _helpTooltip = _map.helpTooltip;\r\n    _continuePolygonMsg = _map.continuePolygonMsg;\r\n    _continueLineMsg = _map.continueLineMsg;\r\n\r\n  } else {\r\n    return\r\n  }\r\n\r\n  if (evt.dragging) {\r\n    return;\r\n  }\r\n  var helpMsg = '点击测量';\r\n\r\n  if (this.sketch) {\r\n    var geom = (this.sketch.getGeometry());\r\n    if (geom instanceof ol.geom.Polygon) {\r\n      helpMsg = _continuePolygonMsg;\r\n    } else if (geom instanceof ol.geom.LineString) {\r\n      helpMsg = _continueLineMsg;\r\n    }\r\n  }\r\n\r\n  _helpTooltipElement.innerHTML = helpMsg;\r\n  _helpTooltip.setPosition(evt.coordinate);\r\n\r\n  _helpTooltipElement.classList.remove('hidden');\r\n};\r\nemMap.prototype.formatLength = function (line) {\r\n  let length = ol.sphere.getLength(line, {\r\n    projection: 'EPSG:4326'\r\n  });\r\n  let output;\r\n  if (length > 100) {\r\n    output = (Math.round(length / 1000 * 100) / 100) +\r\n      ' ' + 'km';\r\n  } else {\r\n    output = (Math.round(length * 100) / 100) +\r\n      ' ' + 'm';\r\n  }\r\n  return output;\r\n};\r\nemMap.prototype.formatArea = function (polygon) {\r\n  let area = ol.sphere.getArea(polygon, {\r\n    projection: 'EPSG:4326'\r\n  });\r\n  let output;\r\n  if (area > 10000) {\r\n    output = (Math.round(area / 1000000 * 100) / 100) +\r\n      ' ' + 'km<sup>2</sup>';\r\n  } else {\r\n    output = (Math.round(area * 100) / 100) +\r\n      ' ' + 'm<sup>2</sup>';\r\n  }\r\n  return output;\r\n};\r\nemMap.prototype.addInteraction = function (_type) {\r\n  let _this = this;\r\n\r\n  let type = (_type == 'area' ? 'Polygon' : 'LineString');\r\n  _this.measure_draw = new ol.interaction.Draw({\r\n    source: _this.measureSource,\r\n    type: type,\r\n    style: new ol.style.Style({\r\n      fill: new ol.style.Fill({\r\n        color: 'rgba(255, 255, 255, 0.4)'\r\n      }),\r\n      stroke: new ol.style.Stroke({\r\n        color: 'rgba(0, 0, 0, 0.5)',\r\n        lineDash: [10, 10],\r\n        width: 2\r\n      }),\r\n      image: new ol.style.Circle({\r\n        radius: 6,\r\n        stroke: new ol.style.Stroke({\r\n          color: 'rgba(0, 0, 0, 0.7)'\r\n        }),\r\n        fill: new ol.style.Fill({\r\n          color: 'rgba(255, 255, 255, 0.8)'\r\n        })\r\n      })\r\n    })\r\n  });\r\n  this.map.addInteraction(_this.measure_draw);\r\n\r\n  this.createMeasureTooltip();\r\n  this.createHelpTooltip();\r\n\r\n  let listener;\r\n  _this.measure_draw.on('drawstart', function (evt) {\r\n    // set sketch\r\n    _this.sketch = evt.feature;\r\n\r\n    var tooltipCoord = evt.coordinate;\r\n\r\n    listener = _this.sketch.getGeometry().on('change', function (evt) {\r\n      var geom = evt.target;\r\n      var output;\r\n      if (geom instanceof ol.geom.Polygon) {\r\n        output = _this.formatArea(geom);\r\n        tooltipCoord = geom.getInteriorPoint().getCoordinates();\r\n      } else if (geom instanceof ol.geom.LineString) {\r\n        output = _this.formatLength(geom);\r\n        tooltipCoord = geom.getLastCoordinate();\r\n      }\r\n      _this.measureTooltipElement.innerHTML = output;\r\n      _this.measureTooltip.setPosition(tooltipCoord);\r\n    });\r\n  }, this);\r\n\r\n  _this.measure_draw.on('drawend', function () {\r\n    _this.measureTooltipElement.className = 'emMeasure-tooltip emMeasure-tooltip-static';\r\n    _this.measureTooltip.setOffset([0, -7]);\r\n    // unset sketch\r\n    _this.sketch = null;\r\n    // unset tooltip so that a new one can be created\r\n    _this.measureTooltipElement = null;\r\n    _this.createMeasureTooltip();\r\n    ol.Observable.unByKey(listener);\r\n  }, this);\r\n};\r\nemMap.prototype.createHelpTooltip = function () {\r\n  let _this = this;\r\n  if (this.helpTooltipElement) {\r\n    this.helpTooltipElement.parentNode.removeChild(this.helpTooltipElement);\r\n  }\r\n  this.helpTooltipElement = document.createElement('div');\r\n  this.helpTooltipElement.className = 'emMeasure-tooltip hidden';\r\n  this.helpTooltip = new ol.Overlay({\r\n    element: _this.helpTooltipElement,\r\n    offset: [15, 0],\r\n    positioning: 'center-left'\r\n  });\r\n  this.helpTooltip_Overlays.push(this.helpTooltip);\r\n  this.map.addOverlay(this.helpTooltip);\r\n};\r\nemMap.prototype.createMeasureTooltip = function () {\r\n  let _this = this;\r\n  if (this.measureTooltipElement) {\r\n    this.measureTooltipElement.parentNode.removeChild(this.measureTooltipElement);\r\n  }\r\n  this.measureTooltipElement = document.createElement('div');\r\n  this.measureTooltipElement.className = 'emMeasure-tooltip emMeasure-tooltip-measure';\r\n  this.measureTooltip = new ol.Overlay({\r\n    element: _this.measureTooltipElement,\r\n    offset: [0, -15],\r\n    positioning: 'bottom-center'\r\n  });\r\n  this.measureTooltip_Overlays.push(this.measureTooltip);\r\n  this.map.addOverlay(this.measureTooltip);\r\n};\r\nemMap.prototype.measureOn = function (_type) {\r\n  this.map.on('pointermove', this.pointerMoveHandler);\r\n  this.map.removeInteraction(this.measure_draw);\r\n  this.addInteraction(_type);\r\n};\r\nemMap.prototype.measureOff = function () {\r\n  let _this = this;\r\n  this.helpTooltip_Overlays.forEach(function (_obj) {\r\n    _this.map.removeOverlay(_obj);\r\n  });\r\n  this.helpTooltip_Overlays = [];\r\n  this.map.un('pointermove', this.pointerMoveHandler);\r\n  this.map.removeInteraction(this.measure_draw);\r\n};\r\nemMap.prototype.measureClear = function () {\r\n  let _this = this;\r\n  this.measureTooltip_Overlays.forEach(function (_obj) {\r\n    _this.map.removeOverlay(_obj);\r\n  });\r\n  this.measureTooltip_Overlays = [];\r\n  this.measureSource.clear();\r\n};\r\n\r\n// 添加火警标注\r\nemMap.prototype.addFireFn = function (_icon, _data) {//添加覆盖物\r\n  /* [{\r\n        id:\"\",\r\n        lng:\"\",\r\n        lat\"\"\r\n   }]*/\r\n  let _this = this;\r\n  for (let i = 0; i < _data.length; i++) {\r\n    $(\"body\").append(`<img id=\"fire_${_data[i].id}\" src=\"images/fire2d.gif\" style=\"width:48px;height:58px;\"/>`);\r\n    let _el = document.getElementById(\"fire_\" + _data[i].id);\r\n    let _popup = new ol.Overlay({\r\n      id: \"fire_\" + _data[i].id,\r\n      position: [_data[i].lng, _data[i].lat],\r\n      offset: [-10, -32],\r\n      element: _el,\r\n      className: \"fire-overlay\"\r\n    });\r\n    _popup.set(\"overlayData\", _data[i]);\r\n    /* _popup.on(\"change:overlayData\", function (e) {\r\n         console.log(123);\r\n         console.log(e.target);\r\n         console.log(e.type);\r\n     });*/\r\n    this.fireOverlays.push(_popup);\r\n    this.map.addOverlay(_popup);\r\n    $(_popup.getElement()).on('click', function () {\r\n      let _data = _popup.get(\"overlayData\");\r\n      _this.fireObj = _data;\r\n      // console.log(_data);\r\n      _this.infoFn({\r\n        type: \"fire\",\r\n        content: _data,\r\n        lng: _data.googleLang,\r\n        lat: _data.googleLat\r\n      });\r\n    }).on(\"mouseover\", function () {\r\n      $(this).css(\"cursor\", 'pointer');\r\n    });\r\n  }\r\n};\r\nemMap.prototype.clearOverlayFn = function (_overlay) {//删除覆盖物\r\n  if (_overlay && _overlay.length > 0) {\r\n    for (let i = 0; i < _overlay.length; i++) {\r\n      this.map.removeOverlay(_overlay[i]);\r\n    }\r\n    this.fireOverlays = [];\r\n  }\r\n};\r\nemMap.prototype.clearXfsExptionOverlayFn = function () {//删除覆盖物\r\n  let _overlays = this.xfsExptionOverlays;\r\n  if (_overlays && _overlays.length > 0) {\r\n    for (let i = 0; i < _overlays.length; i++) {\r\n      this.map.removeOverlay(_overlays[i]);\r\n    }\r\n    this.xfsExptionOverlays = [];\r\n  }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/ol/fn.js"],"sourceRoot":""}