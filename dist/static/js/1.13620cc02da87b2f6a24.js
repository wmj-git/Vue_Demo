webpackJsonp([1],{"1T1o":function(e,t,o){"use strict";t.a=function(e){var t=void 0;switch(e.type){case"TreeDistribution":t='<ul type="none" style="margin: 0px;padding:0px;font-size:22px;" ><li>特殊树木分布</li><li>编号：'+(e.content.id||"")+"</li></ul>";break;case"oilDetective":t=function(e){return'<ul type="none" style="margin: 0px;padding:0px;font-size:22px;" ><li>土壤监测</li><li>编号：'+(e.content.id||"")+"</li></ul>"}(e);break;case"populationDetective":t=function(e){return'<ul type="none" style="margin: 0px;padding:0px;font-size:22px;" ><li>人流量监测</li><li>编号：'+(e.content.id||"")+"</li></ul>"}(e);break;case"airDetective":t=function(e){return'<ul type="none" style="margin: 0px;padding:0px;font-size:22px;" ><li>空气监测</li><li>编号：'+(e.content.id||"")+"</li></ul>"}(e);break;case"fireAlert":t=function(e){return'<ul type="none" style="margin: 0px;padding:0px;font-size:22px;" ><li>火灾报警</li><li>编号：'+(e.content.id||"")+"</li></ul>"}(e);break;case"roadAddress":t=function(e){return'<ul type="none" style="margin: 0px;padding:0px;font-size:22px;" ><li>道路地址</li><li>编号：'+(e.content.id||"")+"</li></ul>"}(e);break;case"district":t=function(e){return'<ul type="none" style="margin: 0px;padding:0px;font-size:22px;" ><li>行政区划</li><li>编号：'+(e.content.id||"")+"</li></ul>"}(e);break;case"protectCompany":t=function(e){return'<ul type="none" style="margin: 0px;padding:0px;font-size:22px;" ><li>养护单位</li><li>编号：'+(e.content.id||"")+"</li></ul>"}(e);break;default:t='<span style="color: white;">无数据</span>'}return t}},"1WoT":function(e,t,o){"use strict";(function(e){t.b=function(t,o,r,a){var n={type:"typeName",titleKey:"id",iconUrl:""};for(var i in n)o[i]&&(n[i]=o[i]);var l=[],s=(t||"")+"/query/?f=json&returnGeometry=true&spatialRel=esriSpatialRelIntersects&geometry="+encodeURIComponent('{"xmin":-180,"ymin":-90,"xmax":180,"ymax":90,"spatialReference":{"wkid":4490}}')+"&geometryType=esriGeometryEnvelope&inSR=4490&outFields=*&outSR=4490";e.ajax({url:s,async:!0,dataType:"json",success:function(e){console.log("response"),console.log(e),e.error?console.log(e.error.message+"\n"+e.error.details.join("\n")):(e.features.forEach(function(e){l.push(e)}),console.log(l))}});new ol.format.EsriJSON;var c=new ol.source.Vector({wrapX:!1}),u=new ol.source.Cluster({distance:a,source:c});var p={};return{layer:new ol.layer.Vector({name:n.type+"_layer",layer_type:"Cluster",source:u,style:function(e){var t,o=e.get("features").length,a=p[o];if(o>1)a||(a=new ol.style.Style({image:new ol.style.Icon({anchor:[.5,28],anchorXUnits:"fraction",anchorYUnits:"pixels",opacity:.8,scale:1.28,color:r,src:"../../static/image/cluster.png"}),text:new ol.style.Text({text:o.toString(),fill:new ol.style.Fill({color:"#fff"})})}),p[o]=a);else{var i=e.get("features")[0];t=i.get(n.titleKey),a=new ol.style.Style({image:new ol.style.Icon({anchor:[0,0],anchorXUnits:"fraction",anchorYUnits:"pixels",scale:.4,src:n.iconUrl+""}),text:new ol.style.Text({text:t+"",offsetX:12,offsetY:-8,fill:new ol.style.Fill({color:"#fff"}),stroke:new ol.style.Stroke({color:"rgba(0, 0, 0, 0.6)",width:4})})})}return a}}),vectorSource:c,clusterSource:u}},t.d=function(e,t,o){var r=[],a=null,n=null,i={type:"layerName",geomType:"Point"};for(var s in i)t[s]&&(i[s]=t[s]);var c={type:"",titleKey:"id",strokeWidth:2,strokeColor:"[255, 0, 0, 1.0]",fillColor:"[0, 0, 255, 1.0]"};for(var u in c)o[u]&&(c[u]=o[u]);a=new ol.source.Vector({wrapX:!1}),console.log(e);for(var p=0;p<e.length;++p){if("point"===i.geomType){var d=[e[p].gpsLongitude,e[p].gpsLatitude];r[p]=new ol.Feature({geometry:new ol.geom.Point(d),featureData:e[p]})}else if("text"===i.geomType){var m=[e[p].gpsLongitude,e[p].gpsLatitude];r[p]=new ol.Feature({geometry:new ol.geom.Point(m),featureData:e[p]}),r[p].setStyle(l(e[p],c))}else if("line"===i.geomType){var y=e[p].coordinates?e[p].coordinates:[];r[p]=new ol.Feature({geometry:new ol.geom.LineString(y),featureData:e[p]}),r[p].setStyle(l(e[p],c))}else if("polygon"===i.geomType){var f=e[p].coordinates?e[p].coordinates:[];r[p]=new ol.Feature({geometry:new ol.geom.Polygon(f),featureData:e[p]}),r[p].setStyle(l(e[p],c))}else if("circle"===i.geomType){var h=[e[p].gpsLongitude,e[p].gpsLatitude],g=e[p].radius?e[p].radius:10,v=new ol.geom.Circle(ol.proj.transform(h,"EPSG:4326","EPSG:3857"),g,"XY"),w=v.transform("EPSG:3857","EPSG:4326");r[p]=new ol.Feature({geometry:w,featureData:e[p]}),r[p].setStyle(l(e[p],c))}r[p].setId(i.geomType+"_"+i.type+"_"+e[p].id)}return a.addFeatures(r),n=new ol.layer.Vector({name:i.type+"_layer",layer_type:"Layer",source:a}),{features:r,source:a,layer:n}},t.a=function(e,t,o,r){var a={type:"typeName",titleKey:"id",iconUrlKey:"iconUrl"};for(var n in a)t[n]&&(a[n]=t[n]);for(var i=[],l=0;l<e.length;++l){var s=[e[l].gpsLongitude,e[l].gpsLatitude];i[l]=new ol.Feature({geometry:new ol.geom.Point(s),featureData:e[l]}),i[l].setId("marker_"+a.type+"_"+e[l].id)}var c=new ol.source.Cluster({distance:r,source:new ol.source.Vector({features:i})});var u={},p=new ol.layer.Vector({name:a.type+"_layer",layer_type:"Cluster",source:c,style:function(e){var t,r=e.get("features").length,n=u[r];if(r>1)n||(n=new ol.style.Style({image:new ol.style.Icon({anchor:[.5,28],anchorXUnits:"fraction",anchorYUnits:"pixels",opacity:.8,scale:1.28,color:o,src:"../../static/image/cluster.png"}),text:new ol.style.Text({text:r.toString(),fill:new ol.style.Fill({color:"#fff"})})}),u[r]=n);else{var i=e.get("features")[0];t=i.get("featureData"),n=new ol.style.Style({image:new ol.style.Icon({anchor:[32,62],anchorXUnits:"pixels",anchorYUnits:"pixels",scale:.4,src:t[a.iconUrlKey]+""}),text:new ol.style.Text({text:t[a.titleKey]+"",offsetX:0,offsetY:-32,fill:new ol.style.Fill({color:"#fff"}),stroke:new ol.style.Stroke({color:"rgba(0, 0, 0, 0.6)",width:4})})})}return n}});return{features:i,source:c,layer:p}},t.c=s;var r=o("IcnI"),a=o("zsQ6"),n=o("1T1o");function i(e){var t=Math.abs(e),o=Math.floor(t);return o+"°"+Math.floor(60*(t-o))+"'"+Math.round(3600*(t-o)%60)+'"'}function l(e,t){var o=null,r=JSON.parse(t.fillColor),a=JSON.parse(t.strokeColor);switch(r[3]=r[3]/255,a[3]=a[3]/255,t.type){case"1":o=new ol.style.Style({stroke:new ol.style.Stroke({width:t.strokeWidth,color:a}),fill:new ol.style.Fill({color:r}),text:new ol.style.Text({text:e[t.titleKey]?e[t.titleKey]+"":"",offsetX:0,offsetY:-28,fill:new ol.style.Fill({color:"#fff"}),stroke:new ol.style.Stroke({color:"rgba(0, 0, 0, 0.6)",width:4})})});break;case"2":o=new ol.style.Style({text:new ol.style.Text({text:e[t.titleKey]?e[t.titleKey]+"":"",fill:new ol.style.Fill({color:JSON.parse(t.fillColor)}),stroke:new ol.style.Stroke({color:JSON.parse(t.strokeColor),width:t.strokeWidth})})})}return o}function s(e){this.el=e,this.resolutions=[.00059486525145757,.000297432625728785,.00015228550437313792,7614275218656896e-20,3807137609328448e-20,1903568804664224e-20,951784402332112e-20,475892201166056e-20,237946100583028e-20,118973050291514e-20,5.9486525145757e-7,2.97432625728785e-7],this.map=null,this.view=null,this.Info=null,this.InfoOverlay=null,this.coordinate_container=null,this.coordinate_content=null,this.coordinate_closer=null,this.coordinate_overlay=null,this.measureSource=null,this.measureVector=null,this.helpTooltip_Overlays=[],this.measureTooltip_Overlays=[],this.sketch=null,this.helpTooltipElement=null,this.helpTooltip=null,this.measureTooltipElement=null,this.measureTooltip=null,this.continuePolygonMsg="测量面积",this.continueLineMsg="测量距离",this.measure_draw=null}s.prototype.init=function(t,o){var r=this,a=this.resolutions;this.view=new ol.View({resolutions:a,center:t,zoom:1,maxZoom:19,minZoom:0,projection:"EPSG:4326"}),this.map=new ol.Map({controls:ol.control.defaults({attribution:!1,zoom:!1,rotate:!0}).extend([]),target:r.el,layers:o,view:r.view}),this.map.on("moveend",function(e){var t=e.map,o=t.getView().calculateExtent(t.getSize()),a=(ol.extent.getCenter(o),r.view.getZoom()),n=t.getLayers().getArray();a>5?n.forEach(function(e){var t=e.getSource();"Cluster"===e.get("layer_type")&&t.setDistance(0)}):n.forEach(function(e){var t=e.getSource();"Cluster"===e.get("layer_type")&&t.setDistance(50)})}),e("body").append('<div id="em_ol_info" class="em-tooltip em-tooltip-static" style="z-index: 800"></div>'),this.Info=document.getElementById("em_ol_info"),this.InfoOverlay=new ol.Overlay({element:this.Info,positioning:"bottom-center",stopEvent:!1,offset:[6,-32],autoPan:!0,autoPanAnimation:{duration:100}}),this.map.addOverlay(this.InfoOverlay),this.map.on("pointermove",this.InfoPointermoveFn),this.map.on("click",this.InfoClickFn),this.measureSource=new ol.source.Vector,this.measureVector=new ol.layer.Vector({source:this.measureSource,style:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.4)"}),stroke:new ol.style.Stroke({color:"#ffcc33",width:2}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#ffcc33"})})})}),this.map.addLayer(this.measureVector)},s.prototype.viewFn=function(e,t){"none"===t?this.view.animate({zoom:e}):this.view.animate({center:t,zoom:e,duration:100})},s.prototype.InfoClickFn=function(e){var t=r.a.getters["scene/type"];if(window[t]){window[t];var o=e.map.forEachFeatureAtPixel(e.pixel,function(e){return e});if(o){console.log(o);var n=null,i=null;if(o.get("features")&&1===o.get("features").length){var l=o.get("features")[0];n=l.getId().split("_"),i=l.get("featureData")}else{if(!o.get("featureData"))return;n=o.getId().split("_"),i=o.get("featureData")}a.a.$emit("set_drawer",{fn:"showFN",type:n[1],content:i})}}},s.prototype.InfoPointermoveFn=function(t){var o=null,a=r.a.getters["scene/type"];if(window[a]){var n=(o=window[a]).Info;if(t.dragging)e(n).hide();else{var i=t.map.getEventPixel(t.originalEvent),l=t.map.hasFeatureAtPixel(i);e("#"+a).css("cursor",l?"pointer":"");var s=t.map.forEachFeatureAtPixel(t.pixel,function(e){return e});if(s){var c=t.coordinate;if(s.get("features")&&1===s.get("features").length){var u=s.get("features")[0],p=u.getId().split("_");o.infoFn({type:p[1],content:u.get("featureData"),lng:c[0],lat:c[1]})}else{if(!s.get("featureData"))return;var d=s.getId().split("_");o.infoFn({type:d[1],content:s.get("featureData"),lng:c[0],lat:c[1]})}}}}},s.prototype.infoFn=function(t){console.log(t);var o=Object(n.a)(t);e(this.Info).html(o),e(this.Info).show(),this.InfoOverlay.setPosition([t.lng,t.lat])},s.prototype.coordinateLisen=function(e){var t=null,o=null,a=r.a.getters["scene/type"];if(console.log(window[a]),window[a]){t=window[a].coordinate_content,o=window[a].coordinate_overlay;var n=e.coordinate;ol.coordinate.toStringHDMS(ol.proj.toLonLat(n));t.innerHTML="经：<code>"+i(n[0])+"</code>,<br>纬：<code>"+i(n[1])+"</code>",console.log(n),o.setPosition(n)}},s.prototype.coordinateOnFn=function(){var t=this;e("body").append('\n        <div id="coordinate" class="ol-popup">\n            <a href="#" id="coordinate_closer" class="ol-popup-closer"></a>\n            <div id="coordinate_content"></div>\n        </div>\n    '),this.coordinate_container=document.getElementById("coordinate"),this.coordinate_content=document.getElementById("coordinate_content"),this.coordinate_closer=document.getElementById("coordinate_closer"),this.coordinate_overlay=new ol.Overlay({element:this.coordinate_container,autoPan:!0,autoPanAnimation:{duration:100}}),this.coordinate_closer.onclick=function(){return t.coordinate_overlay.setPosition(void 0),t.coordinate_closer.blur(),!1},this.map.addOverlay(this.coordinate_overlay),this.map.on("singleclick",this.coordinateLisen)},s.prototype.coordinateOffFn=function(){e("#coordinate").remove(),this.map.removeOverlay(this.coordinate_overlay),this.map.un("singleclick",this.coordinateLisen)},s.prototype.pointerMoveHandler=function(e){var t=null,o=null,a=null,n=null,i=null,l=r.a.getters["scene/type"];if(window[l]&&(i=window[l])&&(t=i.helpTooltipElement,o=i.helpTooltip,a=i.continuePolygonMsg,n=i.continueLineMsg,!e.dragging)){var s="点击测量";if(this.sketch){var c=this.sketch.getGeometry();c instanceof ol.geom.Polygon?s=a:c instanceof ol.geom.LineString&&(s=n)}t.innerHTML=s,o.setPosition(e.coordinate),t.classList.remove("hidden")}},s.prototype.formatLength=function(e){var t=ol.sphere.getLength(e,{projection:"EPSG:4326"});return t>100?Math.round(t/1e3*100)/100+" km":Math.round(100*t)/100+" m"},s.prototype.formatArea=function(e){var t=ol.sphere.getArea(e,{projection:"EPSG:4326"});return t>1e4?Math.round(t/1e6*100)/100+" km<sup>2</sup>":Math.round(100*t)/100+" m<sup>2</sup>"},s.prototype.addInteraction=function(e){var t=this,o="area"==e?"Polygon":"LineString";t.measure_draw=new ol.interaction.Draw({source:t.measureSource,type:o,style:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.4)"}),stroke:new ol.style.Stroke({color:"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:2}),image:new ol.style.Circle({radius:6,stroke:new ol.style.Stroke({color:"rgba(0, 0, 0, 0.7)"}),fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.8)"})})})}),this.map.addInteraction(t.measure_draw),this.createMeasureTooltip(),this.createHelpTooltip();var r=void 0;t.measure_draw.on("drawstart",function(e){t.sketch=e.feature;var o=e.coordinate;r=t.sketch.getGeometry().on("change",function(e){var r,a=e.target;a instanceof ol.geom.Polygon?(r=t.formatArea(a),o=a.getInteriorPoint().getCoordinates()):a instanceof ol.geom.LineString&&(r=t.formatLength(a),o=a.getLastCoordinate()),t.measureTooltipElement.innerHTML=r,t.measureTooltip.setPosition(o)})},this),t.measure_draw.on("drawend",function(){t.measureTooltipElement.className="emMeasure-tooltip emMeasure-tooltip-static",t.measureTooltip.setOffset([0,-7]),t.sketch=null,t.measureTooltipElement=null,t.createMeasureTooltip(),ol.Observable.unByKey(r)},this)},s.prototype.createHelpTooltip=function(){this.helpTooltipElement&&this.helpTooltipElement.parentNode.removeChild(this.helpTooltipElement),this.helpTooltipElement=document.createElement("div"),this.helpTooltipElement.className="emMeasure-tooltip hidden",this.helpTooltip=new ol.Overlay({element:this.helpTooltipElement,offset:[15,0],positioning:"center-left"}),this.helpTooltip_Overlays.push(this.helpTooltip),this.map.addOverlay(this.helpTooltip)},s.prototype.createMeasureTooltip=function(){this.measureTooltipElement&&this.measureTooltipElement.parentNode.removeChild(this.measureTooltipElement),this.measureTooltipElement=document.createElement("div"),this.measureTooltipElement.className="emMeasure-tooltip emMeasure-tooltip-measure",this.measureTooltip=new ol.Overlay({element:this.measureTooltipElement,offset:[0,-15],positioning:"bottom-center"}),this.measureTooltip_Overlays.push(this.measureTooltip),this.map.addOverlay(this.measureTooltip)},s.prototype.measureOn=function(e){this.map.on("pointermove",this.pointerMoveHandler),this.map.removeInteraction(this.measure_draw),this.addInteraction(e)},s.prototype.measureOff=function(){var e=this;this.helpTooltip_Overlays.forEach(function(t){e.map.removeOverlay(t)}),this.helpTooltip_Overlays=[],this.map.un("pointermove",this.pointerMoveHandler),this.map.removeInteraction(this.measure_draw)},s.prototype.measureClear=function(){var e=this;this.measureTooltip_Overlays.forEach(function(t){e.map.removeOverlay(t)}),this.measureTooltip_Overlays=[],this.measureSource.clear()}}).call(t,o("7t+N"))},"C+lO":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o("GKmE");var a=o("1WoT");var n={db:{},openScene:function(e){return window[e]||(window[e]=new a.c(e)),{mapName:e}},baseMapFN:function(){var e=function(e){return function(t,o,r){var a,n=t.length,i=r||2;a=o||(2!==i?t.slice():new Array(n));for(var l=0;l<n;l+=i)e(t,a,l);return a}},t={},o=Math.PI/180;t.forward=e(function(e,t,r){var a=Math.max(Math.min(85.0511287798,e[r+1]),-85.0511287798),n=Math.sin(a*o);t[r]=6378137*e[r]*o,t[r+1]=6378137*Math.log((1+n)/(1-n))/2}),t.inverse=e(function(e,t,r){t[r]=e[r]/6378137/o,t[r+1]=(2*Math.atan(Math.exp(e[r+1]/6378137))-Math.PI/2)/o});var r={},a=[12890594.86,8362377.87,5591021,3481989.83,1678043.12,0],n=[75,60,45,30,15,0],i=[[1.410526172116255e-8,898305509648872e-20,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,17337981.2],[-7.435856389565537e-9,8983055097726239e-21,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,10260144.86],[-3.030883460898826e-8,898305509983578e-20,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,6856817.37],[-1.981981304930552e-8,8983055099779535e-21,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,4482777.06],[3.09191371068437e-9,8983055096812155e-21,6995724062e-14,23.10934304144901,-.00023663490511,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,2555164.4],[2.890871144776878e-9,8983055095805407e-21,-3.068298e-8,7.47137025468032,-353937994e-14,-.02145144861037,-1234426596e-14,.00010322952773,-323890364e-14,826088.5]],l=[[-.0015702102444,111320.7020616939,0x60e374c3105a3,-0x24bb4115e2e164,0x5cc55543bb0ae8,-0x7ce070193f3784,0x5e7ca61ddf8150,-0x261a578d8b24d0,0x665d60f3742ca,82.5],[.0008277824516172526,111320.7020463578,647795574.6671607,-4082003173.641316,10774905663.51142,-15171875531.51559,12053065338.62167,-5124939663.577472,913311935.9512032,67.5],[.00337398766765,111320.7020202162,4481351.045890365,-23393751.19931662,79682215.47186455,-115964993.2797253,97236711.15602145,-43661946.33752821,8477230.501135234,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837.749470245,992013.7397791013,-1221952.21711287,1340652.697009075,-620943.6990984312,144416.9293806241,37.5],[-.0003441963504368392,111320.7020576856,278.2353980772752,2485758.690035394,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-.0003218135878613132,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]];function s(e,t,o,r){var a=e[o],n=e[o+1],i=r[0]+r[1]*Math.abs(a),l=Math.abs(n)/r[9],s=r[2]+r[3]*l+r[4]*l*l+r[5]*l*l*l+r[6]*l*l*l*l+r[7]*l*l*l*l*l+r[8]*l*l*l*l*l*l;t[o]=i*(a<0?-1:1),t[o+1]=s*(n<0?-1:1)}r.forward=e(function(e,t,o){var r,a,i,c,u=function(e,t,o){for(var r=o-t;e>o;)e-=r;for(;e<t;)e+=r;return e}(e[o],-180,180),p=(r=e[o+1],a=-74,i=74,r=Math.max(r,a),r=Math.min(r,i)),d=null;for(c=0;c<n.length;++c)if(p>=n[c]){d=l[c];break}if(null===d)for(c=n.length-1;c>=0;--c)if(p<=-n[c]){d=l[c];break}t[o]=u,t[o+1]=p,s(t,t,o,d)}),r.inverse=e(function(e,t,o){for(var r=Math.abs(e[o+1]),n=null,l=0;l<a.length;l++)if(r>=a[l]){n=i[l];break}s(e,t,o,n)});var c={},u=Math.PI,p=6378245,d=.006693421622965943;function m(e,t){var o,r,a,n=(a=2*(o=e-105)-100+3*(r=t-35)+.2*r*r+.1*o*r+.2*Math.sqrt(Math.abs(o)),a+=2*(20*Math.sin(6*o*u)+20*Math.sin(2*o*u))/3,a+=2*(20*Math.sin(r*u)+40*Math.sin(r/3*u))/3,a+=2*(160*Math.sin(r/12*u)+320*Math.sin(r*u/30))/3),i=function(e,t){var o=300+e+2*t+.1*e*e+.1*e*t+.1*Math.sqrt(Math.abs(e));return o+=2*(20*Math.sin(6*e*u)+20*Math.sin(2*e*u))/3,o+=2*(20*Math.sin(e*u)+40*Math.sin(e/3*u))/3,o+=2*(150*Math.sin(e/12*u)+300*Math.sin(e/30*u))/3}(e-105,t-35),l=t/180*u,s=Math.sin(l);s=1-d*s*s;var c=Math.sqrt(s);return n=180*n/(p*(1-d)/(s*c)*u),[i=180*i/(p/c*Math.cos(l)*u),n]}function y(e,t){return e<72.004||e>137.8347||t<.8293||t>55.8271}c.toWGS84=e(function(e,t,o){var r=e[o],a=e[o+1];if(!y(r,a)){var n=m(r,a);r-=n[0],a-=n[1]}t[o]=r,t[o+1]=a}),c.fromWGS84=e(function(e,t,o){var r=e[o],a=e[o+1];if(!y(r,a)){var n=m(r,a);r+=n[0],a+=n[1]}t[o]=r,t[o+1]=a});var f={},h=3e3*(u=Math.PI)/180;function g(e,t,o){var r=e[o]-.0065,a=e[o+1]-.006,n=Math.sqrt(r*r+a*a)-2e-5*Math.sin(a*h),i=Math.atan2(a,r)-3e-6*Math.cos(r*h);return t[o]=n*Math.cos(i),t[o+1]=n*Math.sin(i),t}function v(e,t,o){var r=e[o],a=e[o+1],n=Math.sqrt(r*r+a*a)+2e-5*Math.sin(a*h),i=Math.atan2(a,r)+3e-6*Math.cos(r*h);return t[o]=n*Math.cos(i)+.0065,t[o+1]=n*Math.sin(i)+.006,t}f.toWGS84=function(t,o,r){var a=e(g)(t,o,r);return c.toWGS84(a,a,r)},f.fromWGS84=function(t,o,r){var a=c.fromWGS84(t,o,r);return e(v)(a,a,r)};var w={smerc2bmerc:function(e,o,a){var n=t.inverse(e,o,a);return n=f.fromWGS84(n,n,a),r.forward(n,n,a)},bmerc2smerc:function(e,o,a){var n=r.inverse(e,o,a);return n=f.toWGS84(n,n,a),t.forward(n,n,a)},bmerc2ll:function(e,t,o){var a=r.inverse(e,t,o);return f.toWGS84(a,a,o)},ll2bmerc:function(e,t,o){var a=f.fromWGS84(e,t,o);return r.forward(a,a,o)}};w.ll2smerc=t.forward,w.smerc2ll=t.inverse;var _=[72.004,.8293,137.8347,55.8271],b=new ol.proj.Projection({code:"baidu",extent:ol.extent.applyTransform(_,w.ll2bmerc),units:"m"});ol.proj.addProjection(b),ol.proj.addCoordinateTransforms("EPSG:4326",b,w.ll2bmerc,w.bmerc2ll),ol.proj.addCoordinateTransforms("EPSG:3857",b,w.smerc2bmerc,w.bmerc2smerc);for(var x=new Array(19),T=0;T<19;++T)x[T]=Math.pow(2,18-T);var M=new ol.layer.Tile({name:"baseMap_layer",source:new ol.source.XYZ({projection:"baidu",maxZoom:18,tileUrlFunction:function(e){return"http://online4.map.bdimg.com/tile/?qt=vtile&x="+e[1]+"&y="+e[2]+"&z="+e[0]+"&styles=pl&scaler=1&udt=20190521"},tileGrid:new ol.tilegrid.TileGrid({resolutions:x,origin:[0,0],extent:ol.extent.applyTransform(_,w.ll2bmerc),tileSize:[256,256]})})}),S=new ol.layer.Tile({name:"baseMap_layer",opacity:1,source:new ol.source.XYZ({projection:"baidu",maxZoom:18,tileUrlFunction:function(e){return"http://shangetu2.map.bdimg.com/it/u=x="+e[1]+";y="+e[2]+";z="+e[0]+";v=009;type=sate&fm=46&udt=20190521"},tileGrid:new ol.tilegrid.TileGrid({resolutions:x,origin:[0,0],extent:ol.extent.applyTransform(_,w.ll2bmerc),tileSize:[256,256]})})}),k=new ol.layer.Tile({name:"baseMap_layer",source:new ol.source.XYZ({projection:"baidu",maxZoom:18,tileUrlFunction:function(e){return"http://online4.map.bdimg.com/tile/?qt=vtile&x="+e[1]+"&y="+e[2]+"&z="+e[0]+"&styles=sl&scaler=1&udt=20190521"},tileGrid:new ol.tilegrid.TileGrid({resolutions:x,origin:[0,0],extent:ol.extent.applyTransform(_,w.ll2bmerc),tileSize:[256,256]})})});function E(e,t,o,r){for(var a=ol.proj.get(t),n=a.getExtent(),i=ol.extent.getWidth(n)/256,l=new Array(19),s=new Array(19),c=1;c<19;++c)l[c]=i/Math.pow(2,c),s[c]=c;var u=new ol.layer.Tile({name:"baseMap_layer",opacity:o,source:new ol.source.WMTS({attributions:'<a href="http://www.tianditu.com/service/info.html?sid=5292&type=info">天地图</a>',url:"http://t0.tianditu.gov.cn/"+e+"/wmts?tk="+r,layer:e.substr(0,3),matrixSet:e.substring(4),format:"tiles",projection:a,tileGrid:new ol.tilegrid.WMTS({origin:ol.extent.getTopLeft(n),resolutions:l,matrixIds:s}),style:"default",wrapX:!0})});return u.id=e,u}var F=E("vec_c","EPSG:4326",1,"dcfb31be4b1daef33e484e48348cb28b"),L=E("img_c","EPSG:4326",1,"dcfb31be4b1daef33e484e48348cb28b"),I=new ol.layer.Tile({name:"baseMap_layer",opacity:1,source:new ol.source.XYZ({url:"http://192.168.20.125:800/sceneData/zhlh_vec/{z}/{x}/{y}.png",wrapX:!1}),projection:"EPSG:4326"}),C=new ol.layer.Tile({name:"baseMap_layer",opacity:1,source:new ol.source.XYZ({url:"http://192.168.20.125:800/sceneData/zhlh_img/{z}/{x}/{y}.png",wrapX:!1}),projection:"EPSG:4326"});return new ol.layer.Tile({name:"baseMap_layer",opacity:1,source:new ol.source.XYZ({url:"http://192.168.20.125:800/sceneData/zhlh_img/{z}/{x}/{y}.png",wrapX:!1}),projection:"EPSG:4326"}),{baidu_vec:M,baidu_img:S,baidu_cva:k,osmLayer_vec:I,osmLayer_img:C,tLayer_vec:F,tLayer_img:L}},layerFN:a.d,clustersFn:a.a,clustersLayerFn:a.b},i=o("cnhE"),l=o("QDbo"),s=o("Ir+4"),c={data:function(){return{id:"map"}},props:{},methods:{init:function(){var e=this;if(document.getElementById("ol_js"))e.mapInit(),e.layerInit();else{var t="http://192.168.20.18:1800";console.log("css",t),Object(r.d)("ol_css",t+"/sceneStatic/ol/ol.css",function(){console.log("css")}),Object(r.e)("ol_js",t+"/sceneStatic/ol/ol.js",function(){console.log("js"),e.mapInit(),e.layerInit()})}},layerInit:function(){var e=this,t=this.$store.getters["scene/layerData"];console.log("_Tabs"),console.log(t),t.forEach(function(t){t.data.addTab="false",e[t.data.fn](t.data)})},mapInit:function(){window[this.id].init([114.031047,22.663679],[n.baseMapFN().baidu_vec])},spaceTimeBaseMap:function(e){var t="";e.url&&(t=e.url);var o=e.resolutions,r=e.origin;return this.toScene({zIndex:4}),new ol.layer.Tile({name:"baseMap_layer",source:new ol.source.ESRICache({origin:r,resolutions:o,projection:"EPSG:4326",url:t})})},spaceTimeData:function(e){var t=e.data_url,o=e.layer_name,r=e.data_maker_iconUrl,a=e.maker_titleKey,i=e.clusters_color,l=n.clustersLayerFn(t,{type:o,titleKey:a,iconUrl:r},i,48);this.addLayer({layer:l.layer})},baseMapFn:function(e){var t=null;switch(console.log(e),this.removeLayer({layer_name:"baseMap"}),e.layerName){case"1":t=n.baseMapFN().tLayer_vec;break;case"2":t=n.baseMapFN().tLayer_img;break;case"3":t=n.baseMapFN().baidu_vec;break;case"4":t=n.baseMapFN().baidu_img;break;case"5":var o=n.baseMapFN().tLayer_vec;this.addLayer({layer:o,zIndex:-1}),t=this.spaceTimeBaseMap({url:"http://onelz.oicp.vip/proxy/layer/50F068225D3944DD805E7B986D36C7B6/999C1448C6DD4842A35412B42226F0A3/tile/{z}/{y}/{x}",origin:[-180,90],resolutions:[.9410711005830282,.7031250000000002,.3515625000000001,.17578125000000006,.08789062500000003,.043945312500000014,.021972656250000007,.010986328125000003,.005493164062500002,.002746582031250001,.0013732910156250004,.0006866455078125002,.0003433227539062501,.00017166137695312505,8583068847656253e-20,42915344238281264e-21,21457672119140632e-21,10728836059570316e-21,5364418029785158e-21,2682209014892579e-21,134110450744629e-20]});break;case"6":t=this.spaceTimeBaseMap({url:"http://onelz.oicp.vip/proxy/layer/E36DF1E5DD7D4081A1E722ED2C8D7455/999C1448C6DD4842A35412B42226F0A3/tile/{z}/{y}/{x}",origin:[-400,400],resolutions:[.00059486525145757,.000297432625728785,.00015228550437313792,7614275218656896e-20,3807137609328448e-20,1903568804664224e-20,951784402332112e-20,475892201166056e-20,237946100583028e-20,118973050291514e-20,5.9486525145757e-7,2.97432625728785e-7]});break;case"7":t=n.baseMapFN().osmLayer_vec;break;case"8":t=n.baseMapFN().osmLayer_img}this.addLayer({layer:t,zIndex:-1})},xyz:function(e){console.log(e),e.trigger?window[this.id].coordinateOnFn():window[this.id].coordinateOffFn()},measure_drawPloy:function(e){window[this.id].measureOn("area")},measure_drawLine:function(e){window[this.id].measureOn("distance")},measure_clear:function(e){window[this.id].measureClear(),window[this.id].measureOff()},toScene:function(e){var t=e.zIndex?e.zIndex:1,o=e.lng?e.lng:114.031047,r=e.lat?e.lat:22.663679;window[this.id].viewFn(t,[o,r])},addLayer:function(e){var t=e.layer;e.zIndex&&t.setZIndex(e.zIndex),window[this.id].map.addLayer(t)},removeLayer:function(e){var t=window[this.id].map;t.getLayers().getArray().forEach(function(o){console.log(o.get("name"));var r=e.layer_name+"_layer";o.get("name")===r&&t.removeLayer(o)})},scene_data:function(e){switch(console.log(e),e.data_type){case"1":e.trigger?this.queryVicinityPrintFn(e):this.removeLayer({layer_name:e.layer_name});break;case"2":e.trigger?this.spaceTimeData(e):this.removeLayer({layer_name:e.layer_name});break;case"3":e.trigger?this.geomDataFn(e):(this.removeLayer({layer_name:e.layer_name}),this.bus.$emit("scene_data_emTabs",{fn:"removeTabFn",name:e.layer_name,title:e.layer_title}));break;case"4":e.trigger?this.markerDataFn(e):(this.removeLayer({layer_name:e.layer_name}),this.bus.$emit("scene_data_emTabs",{fn:"removeTabFn",name:e.layer_name,title:e.layer_title}))}},queryVicinityPrintFn:function(e){var t=this,o={lng:null,lat:null,distance:null,layer_name:"",data_maker_iconUrl:"",maker_titleKey:"",clusters_color:""};for(var r in o)e[r]&&(o[r]=e[r]);Object(i.a)({params:{longitude:o.lng?o.lng:114.03188276054428,latitude:o.lat?o.lat:22.619840297782094,distance:o.distance?o.distance:1e4}}).then(function(e){var r=[];200===e.statusCode&&(e.data.forEach(function(e){e.icon=o.data_maker_iconUrl}),r=e.data);var a=n.clustersFn(r,{type:o.layer_name,titleKey:o.maker_titleKey,iconUrlKey:"icon"},o.clusters_color,30);t.addLayer({layer:a.layer})})},markerDataFn:function(e){var t=this,o={addTab:"true",api_name:"",data_url:"",params:{},layer_name:"",layer_title:"",data_maker_iconUrl:"",maker_titleKey:"",clusters_color:""};for(var r in o)e[r]&&(o[r]=e[r]);for(var a in e){var i=a.split("_");"params"===i[0]&&(o.params[i[1]]=e[a])}"queryVicinityPrint"===o.api_name||"marker"===o.api_name&&Object(l.a)({url:o.data_url,params:o.params}).then(function(r){var a=[];200===r.statusCode&&(r.data.forEach(function(e){e.icon=o.data_maker_iconUrl}),a=r.data);var i=n.clustersFn(a,{type:o.layer_name,titleKey:o.maker_titleKey,iconUrlKey:"icon"},o.clusters_color,50);t.addLayer({layer:i.layer}),"true"===o.addTab&&t.bus.$emit("scene_data_emTabs",{fn:"addTab",name:o.layer_name,title:o.layer_title,data:e,treeData:a,treeChildren:"children",treeLabel:o.maker_titleKey})})},geomDataFn:function(e){var t=this,o={addTab:"true",data_url:"",params:{},layer_name:"",layer_title:"",api_name:"",geomType:"",geom_style:"1",geom_titleKey:"",strokeWidth:2,strokeColor:"[0, 255, 0, 1.0]",fillColor:"[0, 0, 255, 1.0]"};for(var r in o)e[r]&&(o[r]=e[r]);for(var a in e){var i=a.split("_");"params"===i[0]&&(o.params[i[1]]=e[a])}"geom"===o.api_name&&Object(s.a)({url:o.data_url,params:o.params}).then(function(r){var a=[];200===r.statusCode&&(r.data.forEach(function(e){if(e.coordinates&&"line"===o.geomType){var t=JSON.parse(e.coordinates);e.coordinates=t.data}else if(e.coordinates&&"polygon"===o.geomType){var r=[],a=JSON.parse(e.coordinates);r.push(a.data),e.coordinates=r}}),a=r.data);var i=n.layerFN(a,{type:o.layer_name,geomType:o.geomType},{type:o.geom_style,titleKey:o.geom_titleKey,strokeWidth:o.strokeWidth,strokeColor:o.strokeColor,fillColor:o.fillColor});t.addLayer({layer:i.layer}),"true"===o.addTab&&t.bus.$emit("scene_data_emTabs",{fn:"addTab",name:o.layer_name,title:o.layer_title,data:e,treeData:a,treeChildren:"children",treeLabel:o.geom_titleKey})})}},created:function(){this.$store.commit("scene/set_type",this.id),this.$store.commit("scene/set_toolbar",[{id:"tool_flyToScene",value:"场景",control_type:"scene",icon:"el-icon-scene",control_id:"",fn:"toScene",trigger:"none"},{id:"tool_coordinates",value:"坐标",control_type:"scene",icon:"el-icon-coordinates",control_id:"",fn:"xyz",trigger:!0},{id:"tool_data",value:"数据",control_type:"tool",icon:"el-icon-data",control_id:"scene_data",fn:"handleData",trigger:!0},{id:"tool_distance",value:"距离",control_type:"scene",icon:"el-icon-distance",control_id:"",fn:"measure_drawLine",trigger:"none"},{id:"tool_area",value:"面积",control_type:"scene",icon:"el-icon-area",control_id:"",fn:"measure_drawPloy",trigger:"none"},{id:"tool_label",value:"清除",control_type:"scene",icon:"el-icon-remove2",control_id:"",fn:"measure_clear",trigger:"none"}]),n.openScene(this.id)},mounted:function(){var e=this;this.init(),this.bus.$on(this.id,function(t){e[t.fn](t)})},beforeDestroy:function(){this.bus.$off(this.id)}},u=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"map"},[t("div",{attrs:{id:this.id}})])};u._withStripped=!0;var p={render:u,staticRenderFns:[]},d=p;var m=!1;var y=o("VU/8")(c,d,!1,function(e){m||o("Cf9Z")},"data-v-41f10c7f",null);y.options.__file="src/views/map/map.vue";t.default=y.exports},Cf9Z:function(e,t,o){var r=o("w3AX");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);o("rjj0")("fb3c5d12",r,!1,{})},"Ir+4":function(e,t,o){"use strict";t.a=function(e){return Object(r.a)({url:e.url,method:"get",params:e.params})};var r=o("vLgD")},QDbo:function(e,t,o){"use strict";t.a=function(e){return Object(r.a)({url:e.url,method:"get",params:e.params})};var r=o("vLgD")},cnhE:function(e,t,o){"use strict";t.a=function(e){return Object(r.a)({url:"/gardens/tree/queryVicinityPrint",method:"get",params:e.params})};var r=o("vLgD")},w3AX:function(e,t,o){(e.exports=o("FZ+f")(!0)).push([e.i,"\n.map[data-v-41f10c7f] {\n  width: 100%;\n  height: 100%;\n  position: fixed;\n}\n.map .el-row .el-col[data-v-41f10c7f] {\n    min-height: 32px;\n    background: rgba(0, 0, 0, 0.4);\n}\n","",{version:3,sources:["F:/web_lh2/zhlh_web/src/views/map/F:/web_lh2/zhlh_web/src/views/map/_map.scss"],names:[],mappings:";AAAA;EACE,YAAW;EACX,aAAY;EACZ,gBAAe;CAOhB;AAVD;IAMM,iBAAgB;IAChB,+BAA8B;CAC/B",file:"map.vue",sourcesContent:[".map {\r\n  width: 100%;\r\n  height: 100%;\r\n  position: fixed;\r\n  .el-row{\r\n    .el-col{\r\n      min-height: 32px;\r\n      background: rgba(0, 0, 0, 0.4);\r\n    }\r\n  }\r\n}\r\n\r\n"],sourceRoot:""}])}});
//# sourceMappingURL=1.13620cc02da87b2f6a24.js.map